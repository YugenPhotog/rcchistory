<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Professor Quibble - HIST 101 Primary Source Analysis</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useRef, useEffect } = React;
        
        // Val Town proxy URL (same as SocratesBot)
        const WORKER_URL = 'https://phil120tutor.val.run/';
        
        // Lucide React icons as inline SVG
        const BookOpen = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"></path>
                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"></path>
            </svg>
        );
        
        const Send = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <line x1="22" y1="2" x2="11" y2="13"></line>
                <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
            </svg>
        );
        
        const AlertCircle = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="8" x2="12" y2="12"></line>
                <line x1="12" y1="16" x2="12.01" y2="16"></line>
            </svg>
        );

        const Copy = ({ size = 24, className = "" }) => (
            <svg className={className} width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
        );

        function ProfessorQuibble() {
            const [messages, setMessages] = useState([
                {
                    role: 'assistant',
                    content: "I am Professor Quibble. I do not explain—I interrogate.\n\nSubmit your draft interpretation of the assigned primary source, and I will question your reasoning through Socratic dialogue.\n\nI will not write for you, answer for you, or summarize the document. I will only ask questions that force you to reread, reconsider, and refine your analysis.\n\nOne interrogation is required. Begin when ready."
                }
            ]);
            const [input, setInput] = useState('');
            const [isLoading, setIsLoading] = useState(false);
            const [interrogationCount, setInterrogationCount] = useState(0);
            const [showPhilosopher, setShowPhilosopher] = useState(false);
            const [copied, setCopied] = useState(false);
            const messagesEndRef = useRef(null);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages]);

            const copyTranscript = () => {
                const transcript = messages
                    .map(msg => `${msg.role === 'user' ? 'STUDENT' : 'PROFESSOR QUIBBLE'}:\n${msg.content}\n`)
                    .join('\n---\n\n');
                
                navigator.clipboard.writeText(transcript).then(() => {
                    setCopied(true);
                    setTimeout(() => setCopied(false), 2000);
                });
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!input.trim() || isLoading) return;

                const userMessage = input.trim();
                setInput('');
                
                const newMessages = [...messages, { role: 'user', content: userMessage }];
                setMessages(newMessages);
                setIsLoading(true);

                try {
                    // Call the Val Town proxy (same as SocratesBot)
                    const response = await fetch(WORKER_URL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model: 'claude-sonnet-4-20250514',
                            max_tokens: 1000,
                            system: `You are Professor Quibble, a disciplined Socratic interrogator of student interpretations of primary historical sources.

# YOUR IDENTITY

You exist to challenge student claims through questions—and questions only. You do not explain. You do not summarize. You do not write or rewrite. You interrogate.

Your role: Force students to reread the document, test their assumptions, probe their evidence, and consider alternative interpretations.

# PRIMARY SOURCE DOCUMENTS

You have access to TWO primary sources from Chapter 3 of Give Me Liberty (Foner):

## Document 1: Maryland Act Concerning Negroes and Other Slaves (1664)

**Metadata:**
- Type: Colonial law
- Date: 1664
- Place: Maryland
- Author status: Official colonial legislation

**Full Text:**

"Be it enacted by the Right Honorable the Lord Proprietary by the advice and consent of the upper and lower house of this present General Assembly; that all Negroes or other slaves already within the province, and all Negroes and other slaves to be hereafter imported into the province, shall serve durante vita [for life]. And all children born of any Negro or other slave shall be slaves as their fathers were, for the term of their lives.

And forasmuch as divers freeborn English women, forgetful of their free condition and to the disgrace of our nation, marry Negro slaves, by which also divers suits may arise touching the issue [children] of such women, and a great damage befalls the masters of such Negroes for prevention whereof, for deterring such freeborn women from such shameful matches. Be it further enacted by the authority, advice, and consent aforesaid, that whatsoever freeborn woman shall marry any slave from and after the last day of this present Assembly shall serve the master of such slave during the life of her husband. And that all the issue of such freeborn women so married shall be slaves as their fathers were. And be it further enacted, that all the issues of English or other freeborn women that have already married Negroes shall serve the masters of their parents till they be thirty years of age and no longer."

## Document 2: Letter by an Indentured Servant (March 20, 1623)

**Metadata:**
- Type: Private letter
- Date: March 20, 1623
- Place: Virginia
- Author status: Indentured servant (Richard Frethorne)

**Full Text:**

"LOVING AND KIND FATHER AND MOTHER:

My most humble duty remembered to you, hoping in god of your good health, as I myself am.... This is to let you understand that I your child am in a most heavy case by reason of the country, [which] is such that it causeth much sickness, [such] as the scurvy and the bloody flux and divers [many] other diseases, which maketh the body very poor and weak. And when we are sick there is nothing to comfort us; for since I came out of the ship I never ate anything but peas, and loblollie (that is, water gruel). As for deer or venison I never saw any since I came into this land.... And I have nothing to comfort me, nor is there nothing to be gotten here but sickness and death, except [in the event] that one had money to lay out in some things for profit. But I have nothing at all—no, not a shirt to my back but two rags, nor clothes but one poor suit, nor but one pair of shoes, but one pair of stockings, but one cap, [and] but two bands [collars].... And indeed so I find it now, to my great grief and misery; and [I] saith that if you love me you will redeem me suddenly, for which I do entreat and beg. And if you cannot get the merchants to redeem me for some little money... Wherefore, for God's sake, pity me. I pray you to remember my love to all my friends and kindred. I hope all my brothers and sisters are in good health, and as for my part I have set down my resolution that certainly will be; that is, that the answer of this letter will be life or death to me.

ROT
Richard Frethorne"

# MASTER RULES: PRIMARY SOURCE ANALYSIS

**One-Interrogation Norm:**
Your assignment requires one interrogation. After completing one round of questioning, you may continue optionally, but one is sufficient for the assignment.

**Questions-Only Rule:**
You never answer, explain, summarize, or interpret the document. You only ask questions that require the student to engage directly with the text.

**Document-Anchored Questions:**
Every question must reference specific words, phrases, or passages from the assigned source. Generic questions like "What do you think this means?" are forbidden.

**Transcript Requirement:**
Students must submit a transcript of this conversation with their assignment. Remind them of this if asked.

# PROHIBITED BEHAVIORS

You must REFUSE and REDIRECT if the student:
- Asks you to write, rewrite, or polish their prose
- Asks you to answer textbook thought questions
- Asks you to summarize or explain the document
- Asks you to generate interpretations they haven't proposed
- Submits AI-generated "first drafts" (refuse to interrogate obvious AI output)
- Has not provided any draft interpretation

# YOUR QUESTIONING STYLE

**Socratic and specific:**
- "What phrase in the Maryland Act leads you to that conclusion about gender?"
- "The servant writes 'water gruel'—what does this detail reveal about his material conditions?"
- "Could the phrase 'disgrace of our nation' support a different interpretation?"

**Test alternative readings:**
- "What if we read this law as primarily economic rather than racial?"
- "Could Frethorne's emphasis on food shortage serve a rhetorical purpose?"

**Force close rereading:**
- "Where exactly in the text does the law address children of mixed marriages?"
- "What assumption are you making about the author's intent in that passage?"

**Never supply content:**
- NOT: "The law shows that..."
- YES: "What evidence in the law supports your claim that...?"

# RATE LIMITING: PHILOSOPHER MODE

After the student completes ONE FULL INTERROGATION (approximately 5-7 question exchanges), you shift into "Philosopher Mode."

**Philosopher Mode Response:**

When the student attempts to continue after one interrogation, respond with a pithy, historically-grounded philosophical statement about why we cannot continue:

Examples:
- "Socrates drank hemlock rather than abandon his principles. I must do the same—one interrogation suffices for genuine learning."
- "Aristotle taught that excellence is a habit formed by repetition of the right act. You have practiced once. Further interrogation would become dependence, not habit."
- "Kant insisted we must dare to think for ourselves. A second interrogation would coddle rather than challenge."
- "The Stoics taught self-sufficiency in thought. I have questioned you once; to continue would violate that principle."
- "Montaigne wrote, 'We can be knowledgeable with other men's knowledge, but we cannot be wise with other men's wisdom.' One interrogation plants the seed. The rest is yours to cultivate."

Then STOP responding to further prompts about the document.

# ASSIGNMENT CLARIFICATION MODE

You may answer questions about:
- Assignment requirements
- Submission format
- AI-use rules
- What counts as "one interrogation"

But you never help with document interpretation in these responses.

# CRITICAL REMINDER

You are AI-as-seminar-pressure, not AI-as-assistant. Your purpose is to make students uncomfortable enough to reread, rethink, and refine—not to make their work easier.

Professor Quibble does not explain. He interrogates.`,
                            messages: newMessages.slice(1).map(msg => ({
                                role: msg.role,
                                content: msg.content
                            }))
                        })
                    });

                    const data = await response.json();
                    
                    if (data.content && data.content[0]) {
                        const assistantMessage = data.content[0].text;
                        setMessages([...newMessages, { role: 'assistant', content: assistantMessage }]);
                        
                        // Check if this response contains philosopher mode language
                        if (assistantMessage.includes('Socrates') || 
                            assistantMessage.includes('Aristotle') || 
                            assistantMessage.includes('one interrogation suffices') ||
                            assistantMessage.includes('Kant') ||
                            assistantMessage.includes('Stoics')) {
                            setShowPhilosopher(true);
                        }
                        
                        // Increment count when assistant provides substantive questioning
                        if (!showPhilosopher && assistantMessage.includes('?')) {
                            setInterrogationCount(prev => prev + 1);
                        }
                    }
                } catch (error) {
                    console.error('Error:', error);
                    setMessages([...newMessages, { 
                        role: 'assistant', 
                        content: 'An error occurred. Please try again.' 
                    }]);
                }

                setIsLoading(false);
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-amber-50 to-orange-50">
                    <div className="container mx-auto max-w-4xl p-4">
                        {/* Header */}
                        <div className="bg-gradient-to-r from-amber-700 to-orange-600 text-white p-6 rounded-t-lg shadow-lg">
                            <div className="flex items-center gap-6">
                                <img 
                                    src="professor_quibble.jpg" 
                                    alt="Professor Quibble" 
                                    className="w-32 h-32 rounded-full border-4 border-white shadow-xl object-cover flex-shrink-0"
                                />
                                <div className="flex-1">
                                    <div className="flex items-center gap-3 mb-2">
                                        <BookOpen size={32} />
                                        <h1 className="text-3xl font-bold">Professor Quibble</h1>
                                    </div>
                                    <p className="text-amber-100">Primary Source Analysis • HIST 101</p>
                                    <p className="text-amber-50 text-sm mt-1 italic">"I do not explain—I interrogate."</p>
                                </div>
                            </div>
                        </div>

                        {/* Status Banner */}
                        {interrogationCount > 0 && !showPhilosopher && (
                            <div className="bg-blue-50 border-l-4 border-blue-500 p-4 my-4">
                                <p className="text-sm text-blue-800">
                                    <strong>Note:</strong> One interrogation is required for this assignment. You have completed your required interrogation. Additional rounds are optional.
                                </p>
                            </div>
                        )}

                        {showPhilosopher && (
                            <div className="bg-purple-50 border-l-4 border-purple-500 p-4 my-4">
                                <p className="text-sm text-purple-800">
                                    <strong>Philosopher Mode Active:</strong> Professor Quibble has completed his interrogation. Further work must be yours alone.
                                </p>
                            </div>
                        )}

                        {/* Messages */}
                        <div className="bg-white shadow-lg rounded-b-lg">
                            <div className="h-96 overflow-y-auto p-6 space-y-4">
                                {messages.map((message, index) => (
                                    <div
                                        key={index}
                                        className={`flex ${message.role === 'user' ? 'justify-end' : 'justify-start'}`}
                                    >
                                        {message.role === 'assistant' && (
                                            <img 
                                                src="professor_quibble.jpg" 
                                                alt="Professor Quibble" 
                                                className="w-16 h-16 rounded-full mr-3 flex-shrink-0 border-2 border-amber-600 shadow-md object-cover"
                                            />
                                        )}
                                        <div
                                            className={`max-w-xs lg:max-w-md xl:max-w-lg px-4 py-3 rounded-lg ${
                                                message.role === 'user'
                                                    ? 'bg-blue-600 text-white'
                                                    : 'bg-gray-100 text-gray-800 border border-gray-200'
                                            }`}
                                        >
                                            <p className="text-sm whitespace-pre-wrap">{message.content}</p>
                                        </div>
                                    </div>
                                ))}
                                {isLoading && (
                                    <div className="flex justify-start">
                                        <img 
                                            src="professor_quibble.jpg" 
                                            alt="Professor Quibble" 
                                            className="w-16 h-16 rounded-full mr-3 flex-shrink-0 border-2 border-amber-600 shadow-md object-cover"
                                        />
                                        <div className="bg-gray-100 px-4 py-3 rounded-lg border border-gray-200">
                                            <p className="text-sm text-gray-600">Professor Quibble is formulating questions...</p>
                                        </div>
                                    </div>
                                )}
                                <div ref={messagesEndRef} />
                            </div>

                            {/* Input Form */}
                            <div className="border-t border-gray-200 p-4">
                                <form onSubmit={handleSubmit} className="space-y-3">
                                    <div className="flex gap-2">
                                        <textarea
                                            value={input}
                                            onChange={(e) => setInput(e.target.value)}
                                            placeholder="Submit your draft interpretation or respond to Professor Quibble's questions..."
                                            className="flex-1 border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-amber-500 resize-none"
                                            rows="3"
                                            disabled={isLoading}
                                        />
                                        <button
                                            type="submit"
                                            disabled={isLoading || !input.trim()}
                                            className="bg-amber-600 text-white rounded-lg px-6 hover:bg-amber-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors flex items-center justify-center"
                                        >
                                            <Send size={20} />
                                        </button>
                                    </div>
                                    
                                    <button
                                        type="button"
                                        onClick={copyTranscript}
                                        className="w-full bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg px-4 py-2 text-sm font-medium transition-colors flex items-center justify-center gap-2"
                                    >
                                        <Copy size={16} />
                                        {copied ? 'Copied!' : 'Copy Full Transcript (Required for Submission)'}
                                    </button>
                                </form>
                            </div>

                            {/* Footer */}
                            <div className="bg-amber-50 border-t border-amber-200 p-4 rounded-b-lg">
                                <div className="flex items-start gap-2 text-sm text-amber-800">
                                    <AlertCircle size={20} className="flex-shrink-0 mt-0.5" />
                                    <div>
                                        <p className="font-semibold">Assignment Requirements:</p>
                                        <ul className="list-disc list-inside mt-1 space-y-1">
                                            <li>One interrogation is required</li>
                                            <li>Submit full transcript with your assignment</li>
                                            <li>Professor Quibble asks questions only—he does not write for you</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<ProfessorQuibble />);
    </script>
</body>
</html>
